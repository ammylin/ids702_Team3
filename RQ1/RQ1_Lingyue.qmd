---
title: "Global Happiness Analysis"
subtitle: "Arvind Kandala, Ammy Lin, Lingyue Hao, Shelly Cao"
execute:
  echo: false
  message: false
  warning: false
editor: visual
format: pdf
---

## Load data

```{r}
library(tidyverse)
library(dplyr)
library(broom)
library(knitr)


happiness <- read.csv("2015_2019_combined.csv")

happiness <- happiness %>%
rename(
country = Country,
region = Region,
rank = Happiness.Rank,
score = Happiness.Score,
se_score = Standard.Error,
gdp_index = Economy..GDP.per.Capita.,
lifeexp_index = Health..Life.Expectancy.,
freedom_index = Freedom,
generosity_index = Generosity,
dystopia_index = Dystopia.Residual,
year = Year
)

glimpse(happiness)
head(happiness)


```

### **Research Question 1:**

Is there a significant association between life expectancy and national happiness, after adjusting for GDP per capita?

### **Model Specification:**

We fit a multiple linear regression model with a national happiness score as the outcome. Life expectancy index and GDP index were included as primary predictors, and we added an interaction between them to explore whether the association between life expectancy and happiness varies depending on a country’s economic status. Including the interaction allowed us to more fully capture the relationship between these two structural indicators while controlling for potential confounding between them. The linear model relies on several core assumptions: (1) the relationship between predictors and the outcome is linear, (2) residuals have constant variance across fitted values, (3) residuals are independent, and (4) residuals are approximately normally distributed.

```{r}
rq1_model1 <- lm(
  score ~ lifeexp_index * gdp_index,
  data = happiness
)

coef_df <- summary(rq1_model1)$coefficients

rq1_table <- tidy(rq1_model1) %>%
select(term, estimate, std.error, statistic, p.value) %>%
mutate(term = recode(
term,
"(Intercept)" = "Intercept",
"lifeexp_index" = "Life expectancy index",
"gdp_index" = "GDP per capita index",
"lifeexp_index:gdp_index" = "Life expectancy × GDP per capita"
),

p.value = ifelse(p.value < 0.001, "<0.001",
sprintf("%.3f", round(p.value, 3)))
)


colnames(rq1_table) <- c("Variable", "Estimate", "Std Error", "t-value", "p-value")

kable(
rq1_table,
caption = "Linear regression model for national happiness",
digits = 3,
booktabs = TRUE,
linesep = "",
align = c("l", "c", "c", "c", "c")
)
```

From Table 1, we see that GDP per capita remains the strongest predictor of national happiness after controlling for life expectancy. Its coefficient is fairly large (≈ 0.63) and highly significant (p \< 0.001), suggesting that happier countries tend to be wealthier on average. In contrast, the main effect for life expectancy is small (≈ 0.21) and not statistically significant (p = 0.425), which means that life expectancy on its own is not clearly linked to reported happiness once differences in national income are taken into account. However, the interaction term between life expectancy and GDP (≈ 1.50, p \< 0.001) is positive and statistically strong. This indicates that the association between life expectancy and happiness becomes more pronounced in higher-income countries. In other words, living longer appears to relate to higher happiness primarily in places where economic conditions are already favorable.

### **Model Assessment:**

```{r}
par(mfrow = c(2,2),         
    mar = c(4,4,2,1),      
    cex = 0.9,              
    cex.axis = 0.9,         
    cex.lab = 0.9,          
    cex.main = 1.1)      

plot(rq1_model1)
```

Based on the four diagnostic plots for our linear model, all of the assumptions are reasonably supported, although a few areas need caution. The residuals-versus-fitted plot shows points scattered fairly evenly around zero without a strong pattern, which suggests that the linearity assumption is mostly acceptable. The Q–Q plot is fairly close to the 45-degree line, especially in the center of the distribution, so the normality assumption is not perfect—there is some deviation in the tails—but the overall pattern is still acceptable for a model of this size. The scale–location plot shows a generally horizontal trend, but with some spread increasing slightly at higher fitted values, which hints at mild heteroskedasticity, though not severe enough to invalidate the model. Finally, the residuals-versus-leverage plot identifies a few observations with higher leverage (for example, points around leverage \> 0.02), but none clearly exceed Cook’s distance, so influential points do not appear to be a major issue.  
